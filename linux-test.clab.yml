name: linux-test

topology:
  nodes:
    # First batch - original 3 switches
    switch01:
      kind: linux
      image: alpine:latest
      binds:
        - snmp-devices:/shared:ro
      exec:
        - apk add --no-cache net-snmp net-snmp-tools
        - mkdir -p /etc/snmp
        - cp /shared/snmpd-1.conf /etc/snmp/snmpd.conf
        - snmpd -f -Lo &
    switch02:
      kind: linux
      image: alpine:latest
      binds:
        - snmp-devices:/shared:ro
      exec:
        - apk add --no-cache net-snmp net-snmp-tools
        - mkdir -p /etc/snmp
        - cp /shared/snmpd-2.conf /etc/snmp/snmpd.conf
        - snmpd -f -Lo &
    switch03:
      kind: linux
      image: alpine:latest
      binds:
        - snmp-devices:/shared:ro
      exec:
        - apkb add --no-cache net-snmp net-snmp-tools
        - mkdir -p /etc/snmp
        - cp /shared/snmpd-3.conf /etc/snmp/snmpd.conf
        - snmpd -f -Lo &
    
    # Scale test batch - adding 17 more devices for 20 total
    switch04:
      kind: linux
      image: alpine:latest
      binds:
        - snmp-devices:/shared:ro
      exec:
        - apk add --no-cache net-snmp net-snmp-tools
        - mkdir -p /etc/snmp
        - cp /shared/snmpd-4.conf /etc/snmp/snmpd.conf
        - snmpd -f -Lo &
    switch05:
      kind: linux
      image: alpine:latest
      binds:
        - snmp-devices:/shared:ro
      exec:
        - apk add --no-cache net-snmp net-snmp-tools
        - mkdir -p /etc/snmp
        - cp /shared/snmpd-5.conf /etc/snmp/snmpd.conf
        - snmpd -f -Lo &
    switch06:
      kind: linux
      image: alpine:latest
      binds:
        - snmp-devices:/shared:ro
      exec:
        - apk add --no-cache net-snmp net-snmp-tools
        - mkdir -p /etc/snmp
        - cp /shared/snmpd-6.conf /etc/snmp/snmpd.conf
        - snmpd -f -Lo &
    switch07:
      kind: linux
      image: alpine:latest
      binds:
        - snmp-devices:/shared:ro
      exec:
        - apk add --no-cache net-snmp net-snmp-tools
        - mkdir -p /etc/snmp
        - cp /shared/snmpd-7.conf /etc/snmp/snmpd.conf
        - snmpd -f -Lo &
    switch08:
      kind: linux
      image: alpine:latest
      binds:
        - snmp-devices:/shared:ro
      exec:
        - apk add --no-cache net-snmp net-snmp-tools
        - mkdir -p /etc/snmp
        - cp /shared/snmpd-8.conf /etc/snmp/snmpd.conf
        - snmpd -f -Lo &
    switch09:
      kind: linux
      image: alpine:latest
      binds:
        - snmp-devices:/shared:ro
      exec:
        - apk add --no-cache net-snmp net-snmp-tools
        - mkdir -p /etc/snmp
        - cp /shared/snmpd-9.conf /etc/snmp/snmpd.conf
        - snmpd -f -Lo &
    switch10:
      kind: linux
      image: alpine:latest
      binds:
        - snmp-devices:/shared:ro
      exec:
        - apk add --no-cache net-snmp net-snmp-tools
        - mkdir -p /etc/snmp
        - cp /shared/snmpd-10.conf /etc/snmp/snmpd.conf
        - snmpd -f -Lo &
    switch11:
      kind: linux
      image: alpine:latest
      binds:
        - snmp-devices:/shared:ro
      exec:
        - apk add --no-cache net-snmp net-snmp-tools
        - mkdir -p /etc/snmp
        - cp /shared/snmpd-11.conf /etc/snmp/snmpd.conf
        - snmpd -f -Lo &
    switch12:
      kind: linux
      image: alpine:latest
      binds:
        - snmp-devices:/shared:ro
      exec:
        - apk add --no-cache net-snmp net-snmp-tools
        - mkdir -p /etc/snmp
        - cp /shared/snmpd-12.conf /etc/snmp/snmpd.conf
        - snmpd -f -Lo &
    switch13:
      kind: linux
      image: alpine:latest
      binds:
        - snmp-devices:/shared:ro
      exec:
        - apk add --no-cache net-snmp net-snmp-tools
        - mkdir -p /etc/snmp
        - cp /shared/snmpd-13.conf /etc/snmp/snmpd.conf
        - snmpd -f -Lo &
    switch14:
      kind: linux
      image: alpine:latest
      binds:
        - snmp-devices:/shared:ro
      exec:
        - apk add --no-cache net-snmp net-snmp-tools
        - mkdir -p /etc/snmp
        - cp /shared/snmpd-14.conf /etc/snmp/snmpd.conf
        - snmpd -f -Lo &
    switch15:
      kind: linux
      image: alpine:latest
      binds:
        - snmp-devices:/shared:ro
      exec:
        - apk add --no-cache net-snmp net-snmp-tools
        - mkdir -p /etc/snmp
        - cp /shared/snmpd-15.conf /etc/snmp/snmpd.conf
        - snmpd -f -Lo &
    switch16:
      kind: linux
      image: alpine:latest
      binds:
        - snmp-devices:/shared:ro
      exec:
        - apk add --no-cache net-snmp net-snmp-tools
        - mkdir -p /etc/snmp
        - cp /shared/snmpd-16.conf /etc/snmp/snmpd.conf
        - snmpd -f -Lo &
    switch17:
      kind: linux
      image: alpine:latest
      binds:
        - snmp-devices:/shared:ro
      exec:
        - apk add --no-cache net-snmp net-snmp-tools
        - mkdir -p /etc/snmp
        - cp /shared/snmpd-17.conf /etc/snmp/snmpd.conf
        - snmpd -f -Lo &
    switch18:
      kind: linux
      image: alpine:latest
      binds:
        - snmp-devices:/shared:ro
      exec:
        - apk add --no-cache net-snmp net-snmp-tools
        - mkdir -p /etc/snmp
        - cp /shared/snmpd-18.conf /etc/snmp/snmpd.conf
        - snmpd -f -Lo &
    switch19:
      kind: linux
      image: alpine:latest
      binds:
        - snmp-devices:/shared:ro
      exec:
        - apk add --no-cache net-snmp net-snmp-tools
        - mkdir -p /etc/snmp
        - cp /shared/snmpd-19.conf /etc/snmp/snmpd.conf
        - snmpd -f -Lo &
    switch20:
      kind: linux
      image: alpine:latest
      binds:
        - snmp-devices:/shared:ro
      exec:
        - apk add --no-cache net-snmp net-snmp-tools
        - mkdir -p /etc/snmp
        - cp /shared/snmpd-20.conf /etc/snmp/snmpd.conf
        - snmpd -f -Lo &

  links: []

mgmt:
  network: clab-mgmt
  ipv4-subnet: 172.20.20.0/24
